

```java
<https://pcmap.place.naver.com/restaurant/list?query=광주> 송정동 맛집
```

- 스크롤 최하위로 내린 뒤 리스트 조회
    
    ```java
    let searchResNm = "짬순이";
    
    let currentHeight = 0; 
    var scrollInterval = setInterval(function() {
      let pageBottom = document.getElementById("_pcmap_list_scroll_container").scrollHeight;
      if(currentHeight < pageBottom) {
        document.getElementById("_pcmap_list_scroll_container").scrollTop = document.getElementById("_pcmap_list_scroll_container").scrollHeight;
        currentHeight = pageBottom;
        console.log('스크롤 중 입니다.');
      } else {
        clearInterval(scrollInterval);
        console.log('스크롤을 끝냈습니다.');
          
        fn_getRestaurantRank();
      }
    }, 500);
    
    function fn_getRestaurantRank(){
        var getInterval = setInterval(function() {
            let result = pageSearch(searchResNm);
            if(result === true ) {
                clearInterval(getInterval);
            }else{
                document.querySelectorAll(".eUTV2")[1].click();
            }
        }, 500);
    }
    
    function pageSearch(searchResNm){
        let resList = document.querySelectorAll("#_pcmap_list_scroll_container li .place_bluelink.TYaxT");
        let pageNum = parseInt(document.querySelector("a.qxokY").innerText);
        
        console.log("현재 조회 중 : ", pageNum);
        console.log("현재 업체 개수: ", resList.length);
        console.log("================= search ... ");
        
        for(let i=0; i<resList.length; i++){	
            let selectCnt = (pageNum-1)*resList.length;		
            let targetNm = resList[i].innerText;
            if(targetNm === searchResNm){
                console.log("업체명 : ",targetNm);
                console.log("현재 순위 : ", selectCnt+(i+1));
                return true;
            }
        }
        return false;
    }
    ```
    

광고 예외처리

```java
function palceRankSearch(searchResNm){
    let currentHeight = 0; 
    var scrollInterval = setInterval(function() {
    let pageBottom = document.getElementById("_pcmap_list_scroll_container").scrollHeight;
    if(currentHeight < pageBottom) {
        document.getElementById("_pcmap_list_scroll_container").scrollTop = document.getElementById("_pcmap_list_scroll_container").scrollHeight;
        currentHeight = pageBottom;
        console.log('스크롤 중 입니다.');
      } else {
        clearInterval(scrollInterval);
        console.log('스크롤을 끝냈습니다.');
          
        fn_getRestaurantRank();
      }
    }, 500);
    
    let lastChk = false;
    let rank = 0;
    let adCnt = 0;
    function fn_getRestaurantRank(){
        var getInterval = setInterval(function() {
            let result = pageSearch(searchResNm);
            
            if(result == true || lastChk == true) {
                if(result == false){
                    console.log("검색 종료. ",searchResNm, "은(는) 300위 이내에 없습니다.");
                }
                clearInterval(getInterval);
            }else{
                document.querySelectorAll(".eUTV2")[1].click();
            }
        }, 1000);
    }
    
    function pageSearch(searchResNm){
        let resList = document.querySelectorAll("#_pcmap_list_scroll_container li");
        let pageNum = parseInt(document.querySelector("a.qxokY").innerText);
    	
        console.log("================= search ... ", pageNum, " / 현재 조회 개수 : ", resList.length );
    		
        for(let i=0; i<resList.length; i++){	
            let selectCnt = (pageNum-1)*resList.length;	
            let targetNm = resList[i].querySelector(".place_bluelink.TYaxT").innerText;
    
            rank ++;
    		if(resList[i].querySelector(".gU6bV.mdfXq")){
                adCnt ++;
            }else if(targetNm == searchResNm){
                let rankCalc = (rank) ;
                let rankAdCalc = (rank-adCnt);
                console.log("업체명 : ",targetNm);
                console.log("현재 순위 : ", rankCalc );
                console.log("광고 제외 순위 : ", rankAdCalc );
                return true;
            }
        }
    		if(pageNum == 6){
    			lastChk = true;
    		}
        return false;
    }
}

// 주소창 url 입력, (플레이스검색키워드) 변경
// <https://pcmap.place.naver.com/restaurant/list?query=플레이스> 검색 키워드
palceRankSearch("삼호식당");
```