

LLM으로 자동 단어사전을 만들 때 **프롬프트가 아무리 잘 짜여 있어도**, 실제 결과가 제대로 안 나오는 문제는 흔합니다. 이유와 해결책을 단계적으로 설명드릴게요.

---

### 🔍 왜 프롬프트대로 안 되는가?

#### 1. **모순된 요구**

예:

- "문서 기반으로만 단어를 추출하라"
    
- "각 분류에 단어를 10개 이상 넣어라"
    

이 두 조건은 충돌할 수 있어요.  
→ 문서 안에 특정 주제(예: '투자 전략') 관련 단어가 4~5개밖에 없으면, 10개 채우는 건 **논리적으로 불가능**하죠. LLM은 이럴 경우:

- 적당히 유사한 걸 "추가"하거나
    
- "조건을 어기고 짧게 반환"하거나
    
- 최악의 경우 "무시하고 엉뚱한 결과"를 낼 수 있어요.
    

#### 2. **"충분한 단어가 없을 경우"의 예외처리 미정**

현재 프롬프트는:

> "10개 이상 포함하라"  
> 라고만 되어 있고,  
> → **못 채울 경우 어떻게 해야 하는지** 지침이 없어요.  
> → LLM은 자체적으로 유추하거나 무시하게 됩니다.

---

### ✅ 해결책 (프롬프트 개정 전략)

#### 🔧 전략 1: 예외 허용 조건 명시

```text
각 카테고리는 관련 단어를 10개 이상 포함해야 합니다.
단, 해당 주제에 대해 문서 내 유의미한 단어가 부족할 경우, 5개 이상만 포함하고 다음 조건을 충족해야 합니다:
- 문서 내 실제 등장한 단어만 사용할 것
- 유사 표현이나 변형 포함 시, 10개 이하로도 허용
```

이렇게 작성하면 **LLM이 조건을 판단할 수 있는 기준**을 갖게 됩니다.

---

#### 🔧 전략 2: 보완 옵션 제공

```text
만약 문서 기반으로 10개 이상 단어가 존재하지 않으면, 일반적인 금융 지식을 기반으로 보완하되,
해당 단어는 [보완] 태그로 구분하여 표기하십시오.
```

→ LLM이 어떤 단어가 문서 기반이고 어떤 것이 외부 지식인지 구분할 수 있어 **투명한 결과 생성** 가능.

---

#### 🔧 전략 3: 데이터 기반 유효성 검증과 연계

최종적으로는 이렇게 해야 합니다:

> LLM이 추출한 결과를 검증 코드로 **실제 문서에 몇 개 등장했는지 확인**하고,  
> 출현율 기준 미달이면 해당 단어는 필터링

→ 이건 LLM의 역할이 아니라 시스템 아키텍처 설계 차원이에요.

---

### 🧠 결론: LLM 프롬프트는 "명확한 기준 + 예외 규칙 + 검증 연계"가 핵심

지금의 프롬프트는 아주 잘 설계된 초안이에요.  
다만, 위 세 가지 관점을 추가하면 **생성 결과의 품질과 일관성**이 훨씬 올라갑니다.

---

필요하시면 지금 프롬프트에 위 내용을 반영해서 **최적화 버전** 만들어드릴게요.  
원하시나요?